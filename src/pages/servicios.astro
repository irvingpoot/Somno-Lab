---
import Layout from '../layouts/Layout.astro';
import Navbar from '../components/Navbar.astro';

const servicios = [
    {
        id: "insomnio",
        titulo: "Insomnio",
        descripcion: "No es solo 'no poder dormir'. Evaluamos las causas psicológicas, físicas y ambientales que fragmentan tu descanso. Nuestros tratamientos cognitivo-conductuales te devuelven el control de tus noches sin depender exclusivamente de fármacos.",
        lista: ["Dificultad para conciliar el sueño", "Despertares nocturnos frecuentes", "Sueño no reparador"],
        img: "https://images.unsplash.com/photo-1520206183501-b80df61043c2?q=80&w=2000&auto=format&fit=crop", // Imagen relajante
        icon: "fa-bed"
    },
    {
        id: "apnea",
        titulo: "Apnea de Sueño",
        descripcion: "Los ronquidos fuertes pueden ser señal de que tu respiración se detiene. Utilizamos estudios de sueño simplificados o completos para diagnosticar la gravedad y ofrecerte soluciones (CPAP, dispositivos orales) que protejan tu salud cardiovascular.",
        lista: ["Ronquidos fuertes", "Pausas respiratorias observadas", "Cansancio excesivo de día"],
        img: "https://images.unsplash.com/photo-1684361435952-7ab2649e0cf5?q=80&w=687&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D", // Tono médico/limpio
        icon: "fa-lungs"
    },
    {
        id: "ritmo",
        titulo: "Ritmo Circadiano",
        descripcion: "Cuando tu reloj interno no coincide con el mundo exterior. Ayudamos a trabajadores por turnos, viajeros frecuentes o personas con fases de sueño retrasadas a sincronizar sus ciclos mediante luminoterapia y cronoterapia.",
        lista: ["Jet Lag social o de viaje", "Trabajo por turnos rotativos", "Insomnio de inicio tardío"],
        img: "https://images.unsplash.com/photo-1765571814233-00a6e91c21a3?q=80&w=687&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D", // Sol/Reloj
        icon: "fa-clock"
    },
    {
        id: "parasomnias",
        titulo: "Parasomnias",
        descripcion: "Eventos físicos indeseables durante el sueño. Desde sonambulismo y terrores nocturnos hasta enuresis. Realizamos un estudio de seguridad para prevenir lesiones y tratar los desencadenantes.",
        lista: ["Sonambulismo", "Pesadillas recurrentes", "Movimientos involuntarios"],
        img: "https://images.unsplash.com/photo-1712071442935-69fda1dbb5a5?q=80&w=687&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D", // Ambiente seguro
        icon: "fa-moon"
    }
];
---

<Layout title="Servicios | SomnoLab">
    <Navbar />

    <main class="bg-slate-50 min-h-screen pt-32 pb-20 relative overflow-hidden">
        
        <div class="absolute top-0 right-0 w-[800px] h-[800px] bg-somno/5 rounded-full blur-[100px] pointer-events-none -z-10 translate-x-1/3 -translate-y-1/4"></div>

        <div class="max-w-7xl mx-auto px-4 sm:px-6">
            
            <div class="text-center mb-16 animate-fade-in-up">
                <span class="text-somno font-bold tracking-[0.2em] uppercase text-xs mb-3 block">
                    Nuestros Servicios
                </span>
                <h1 class="text-4xl md:text-5xl font-black text-slate-800 mb-6 tracking-tight">
                    Identificación y Atención de <br>
                    <span class="text-transparent bg-clip-text bg-gradient-to-r from-somno to-somno-light">Alteraciones del Sueño</span>
                </h1>
                <p class="text-slate-500 max-w-2xl mx-auto text-lg">
                    Selecciona un trastorno para conocer cómo podemos ayudarte a recuperar tu calidad de vida.
                </p>
            </div>

            <div class="flex flex-wrap justify-center gap-4 mb-12 animate-fade-in-up" style="animation-delay: 100ms;">
                {servicios.map((servicio, index) => (
                    <button 
                        class={`tab-btn px-6 py-4 rounded-full font-bold text-sm md:text-base transition-all duration-300 flex items-center gap-3 border border-transparent hover:scale-105 shadow-sm
                        ${index === 0 ? 'bg-white text-somno border-somno shadow-md ring-2 ring-somno/10' : 'bg-white text-slate-500 hover:text-somno hover:shadow'}`}
                        data-target={servicio.id}
                        onclick="switchTab(this)"
                    >
                        <i class={`fas ${servicio.icon}`}></i>
                        {servicio.titulo}
                    </button>
                ))}
            </div>

            <div class="relative min-h-[500px] bg-white rounded-[3rem] shadow-2xl shadow-slate-200/60 overflow-hidden border border-slate-100 animate-fade-in-up" style="animation-delay: 200ms;">
                
                {servicios.map((servicio, index) => (
                    <div 
                        id={servicio.id} 
                        class={`tab-content absolute inset-0 w-full h-full transition-opacity duration-500 flex flex-col md:flex-row
                        ${index === 0 ? 'opacity-100 z-10 relative' : 'opacity-0 z-0 pointer-events-none absolute'}`}
                    >
                        
                        <div class="w-full md:w-1/2 p-10 md:p-16 flex flex-col justify-center order-2 md:order-1">
                            <div class="w-14 h-14 bg-somno/10 text-somno rounded-2xl flex items-center justify-center text-2xl mb-6">
                                <i class={`fas ${servicio.icon}`}></i>
                            </div>
                            
                            <h2 class="text-3xl md:text-4xl font-black text-slate-800 mb-6">
                                {servicio.titulo}
                            </h2>
                            
                            <p class="text-slate-500 text-lg leading-relaxed mb-8">
                                {servicio.descripcion}
                            </p>

                            <ul class="space-y-3 mb-10">
                                {servicio.lista.map(item => (
                                    <li class="flex items-center gap-3 text-slate-600 font-medium">
                                        <i class="fas fa-check-circle text-somno"></i>
                                        {item}
                                    </li>
                                ))}
                            </ul>

                            <a href="/#" class="w-fit bg-slate-900 text-white px-8 py-4 rounded-xl font-bold hover:bg-somno transition-colors shadow-lg hover:shadow-somno/30 flex items-center gap-2">
                                Agendar Diagnóstico <i class="fas fa-arrow-right text-xs"></i>
                            </a>
                        </div>

                        <div class="w-full md:w-1/2 h-64 md:h-auto relative order-1 md:order-2 overflow-hidden">
                            <img 
                                src={servicio.img} 
                                alt={servicio.titulo} 
                                class="absolute inset-0 w-full h-full object-cover transition-transform duration-700 hover:scale-105"
                            />
                            <div class="absolute inset-0 bg-gradient-to-r from-white via-transparent to-transparent md:bg-gradient-to-l opacity-20"></div>
                        </div>

                    </div>
                ))}

            </div>

        </div>
    </main>
</Layout>

<script is:inline>
    function switchTab(btn) {
        // 1. Obtener ID objetivo
        const targetId = btn.getAttribute('data-target');

        // 2. Actualizar Botones
        document.querySelectorAll('.tab-btn').forEach(b => {
            // Estilos Inactivos
            b.classList.remove('text-somno', 'border-somno', 'ring-2', 'ring-somno/10', 'shadow-md');
            b.classList.add('text-slate-500');
        });
        // Estilos Activos (al botón clickeado)
        btn.classList.remove('text-slate-500');
        btn.classList.add('text-somno', 'border-somno', 'ring-2', 'ring-somno/10', 'shadow-md');

        // 3. Actualizar Contenido
        document.querySelectorAll('.tab-content').forEach(content => {
            content.classList.remove('opacity-100', 'z-10', 'relative');
            content.classList.add('opacity-0', 'z-0', 'pointer-events-none', 'absolute');
            
            if (content.id === targetId) {
                // Pequeño delay para permitir que el anterior se desvanezca suavemente si quisieras
                content.classList.remove('opacity-0', 'z-0', 'pointer-events-none', 'absolute');
                content.classList.add('opacity-100', 'z-10', 'relative');
            }
        });
    }
</script>

<style>
    @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-in-up {
        animation: fadeInUp 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
        opacity: 0;
    }

    /* Definimos la animación de movimiento */
    @keyframes shine {
        to {
            background-position: 200% center;
        }
    }
</style>